<!DOCTYPE html>
<html>
<head>
    <title>PhysarumBuddy </title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <div class="left-panel">
            <div class="info-header">Parameter Guide</div>
            <div class="info-section">
                <div class="info-title">üî¢ Agent Count</div>
                <div class="info-text">Controls the density of the simulation by determining how many individual agents (particles) spawn from each mold source. In real Physarum, each agent represents a streaming cytoplasmic tube. Higher counts create denser, more continuous networks but increase computational cost. Default: 18,000 agents per source provides good coverage of the 600px plate.</div>
                <div class="info-formula">total_agents = num_sources √ó agent_count</div>
            </div>
            <div class="info-section">
                <div class="info-title">‚ö° Movement Speed</div>
                <div class="info-text">The step size (in pixels) each agent moves per simulation frame. Represents the rate of cytoplasmic streaming in Physarum. Larger values allow faster exploration of the environment but may cause agents to overshoot optimal paths. Speed affects both exploration time and network refinement.</div>
                <div class="info-formula">new_position = current_position + (direction_vector √ó step_size)</div>
            </div>
            <div class="info-section">
                <div class="info-title">üëÅÔ∏è Sensor Distance</div>
                <div class="info-text">The forward sensing range for each agent. Agents sample three points (left, forward, right) at this distance to detect chemical trails and food gradients. Longer distances enable agents to detect distant food sources earlier, promoting long-range connections. This simulates chemotactic sensing in real slime mold.</div>
                <div class="info-formula">sample_points = [position + direction √ó sensor_dist]</div>
                <div class="info-formula">left_angle = current_angle - 0.45 rad</div>
                <div class="info-formula">right_angle = current_angle + 0.45 rad</div>
            </div>
            <div class="info-section">
                <div class="info-title">üíß Trail Deposit</div>
                <div class="info-text">Amount of pheromone-like chemical deposited by each agent at its current position per timestep. This creates the visible yellow trails. Higher deposits make trails stronger and longer-lasting, encouraging path reinforcement. Agents use these trails for positive chemotaxis, following paths previously taken by themselves and others.</div>
                <div class="info-formula">trail[x, y] += deposit_amount √ó fitness_multiplier</div>
                <div class="info-formula">fitness_multiplier = 0.3 + (agent_fitness / 300)</div>
            </div>
            <div class="info-section">
                <div class="info-title">‚è±Ô∏è Decay Speed</div>
                <div class="info-text">Rate at which chemical trails fade over time. Simulates natural degradation of extracellular matrix in Physarum. Higher values cause faster decay, forcing agents to continuously reinforce useful paths. The decay creates competition: frequently-used paths persist while unused paths disappear, enabling network optimization.</div>
                <div class="info-formula">decay_factor = 1 - (decay_speed √ó 0.001)</div>
                <div class="info-formula">trail[i] *= decay_factor</div>
                <div class="info-formula">if (trail[i] < threshold) trail[i] = 0</div>
            </div>
            <div class="info-section">
                <div class="info-title">üåæ Food Attraction</div>
                <div class="info-text">Strength of the chemical gradient emanating from food sources (oat flakes). Higher values create stronger gradients that guide agents toward food over longer distances. The attraction follows an exponential decay model, with strongest signals near the food. This simulates nutrient chemotaxis in real Physarum.</div>
                <div class="info-formula">gradient_strength = FOOD_ATTRACTION √ó e<sup>(-distance/15)</sup></div>
                <div class="info-formula">sensor_weight += food_map[sensor_position]</div>
            </div>
            <div class="info-section">
                <div class="info-title">üß† Reinforcement Learning</div>
                <div class="info-text">Agents track fitness scores based on proximity to food, trail following, and movement efficiency. High-fitness agents deposit more trail, reinforcing successful paths. Over 3000 steps, the network progressively optimizes, increasing trail-following and pruning inefficient connections.</div>
                <div class="info-formula">fitness += 10 (near food) + 5 (on trail) + 3 (toward food)</div>
                <div class="info-formula">fitness -= 2 (away from food) - 8 (long inefficient paths)</div>
                <div class="info-formula">convergence = min(simulation_steps / 3000, 1.0)</div>
            </div>
        </div>
        
        <div class="middle-panel">
            <canvas id="simCanvas" width="600" height="600"></canvas>
            <div class="simulation-controls">
                <button id="btn-run" class="sim-btn">‚ñ∂Ô∏è Run</button>
                <button onclick="clearSim()" class="sim-btn clear-btn">üóëÔ∏è Clear</button>
            </div>
        </div>
        
        <div class="right-panel">
            <div class="header">
                <h1>PhysarumBuddy</h1>
                <div class="subtitle">Interactive Slime Mold Growth</div>
            </div>
            
            <div class="divider"></div>
                        
            <div class="control-section">
                <div class="section-title">Placement Mode</div>
                <button id="btn-mold">ü¶† Place Mold</button>
                <button id="btn-food">üåæ Place Food</button>
            </div>
            
            <div class="divider"></div>
            
            <div class="control-section">
                <div class="section-title">Quick Setup</div>
                
                <div class="slider-group">
                    <label for="foodCount">Food Pieces: <span id="foodCountValue">8</span></label>
                    <input type="range" id="foodCount" min="3" max="20" step="1" value="8">
                </div>
                
                <button id="btn-auto-setup" class="auto-setup-btn">‚ö° Auto Setup Plate</button>
            </div>
            
            <div class="divider"></div>
            
            <div class="control-section">
                <div class="section-title">Simulation Parameters</div>
                
                <div class="slider-group">
                    <label for="agentCount">Agent Count: <span id="agentCountValue">18000</span></label>
                    <input type="range" id="agentCount" min="0" max="36000" step="1000" value="18000">
                </div>
                
                <div class="slider-group">
                    <label for="stepSize">Movement Speed: <span id="stepSizeValue">3.0</span></label>
                    <input type="range" id="stepSize" min="0" max="6.0" step="0.1" value="3.0">
                </div>
                
                <div class="slider-group">
                    <label for="sensorDist">Sensor Distance: <span id="sensorDistValue">30</span></label>
                    <input type="range" id="sensorDist" min="0" max="60" step="1" value="30">
                </div>
                
                <div class="slider-group">
                    <label for="depositAmount">Trail Deposit: <span id="depositAmountValue">6</span></label>
                    <input type="range" id="depositAmount" min="0" max="12" step="1" value="6">
                </div>
                
                <div class="slider-group">
                    <label for="decaySpeed">Decay Speed: <span id="decaySpeedValue">5</span></label>
                    <input type="range" id="decaySpeed" min="0" max="10" step="1" value="5">
                </div>
                
                <div class="slider-group">
                    <label for="foodAttraction">Food Attraction: <span id="foodAttractionValue">10.0</span></label>
                    <input type="range" id="foodAttraction" min="0" max="20.0" step="0.5" value="10.0">
                </div>
                
                <button class="clear-btn" onclick="resetParameters()" style="margin-top: 15px;">üîÑ Reset Parameters</button>
            </div>
            
            <div class="divider"></div>
            
            <div class="instructions">
                <strong>How to use:</strong><br>
                1. Adjust parameters with sliders above<br>
                2. Click on the agar plate to place mold starting point<br>
                3. Switch to food mode and place oat flakes<br>
                4. Press "Run Simulation" to watch the network form<br>
                5. Observe how it finds efficient paths between food sources
            </div>
            
            <div class="stats" id="stats">Agents: 0 | Food: 0 | Sources: 0</div>
        </div>
    </div>

    <script src="config.js"></script>
    <script src="agent.js"></script>
    <script src="simulation.js"></script>
    <script src="ui.js"></script>
</body>
</html>
